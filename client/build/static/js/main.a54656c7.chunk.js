(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,A,t){"use strict";t.r(A);var a=t(0),n=t.n(a),l=t(38),c=t.n(l),o=(t(49),t(19)),r=t(12),i=t(7),s=t(8),m=t(11),u=t(9),d=t(10),h=t(39),p=t(17),v=t.n(p),E=t(18),b=t.n(E),V=t(40),f=function(e){function A(){var e;return Object(i.a)(this,A),(e=Object(m.a)(this,Object(u.a)(A).call(this))).state={auth:"",code:""},e._confettiEffect=null,e.redirectTimeout=5e3,e}return Object(d.a)(A,e),Object(s.a)(A,[{key:"componentDidMount",value:function(){var e=v.a.parse(this.props.location.search),A=setInterval(this.checkAuth.bind(this),1e3,1);this.setState({auth:e.auth,code:e.code,intervalId:A,authenticated:!1,opentok:null}),this._confettiEffect=new V.a({target:"auth-completed-confetti"})}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.intervalId)}},{key:"checkAuth",value:function(){var e=this,A=this.state,t=A.auth,a=A.intervalId;this.props.history;b.a.post("https://auuubonz7g.execute-api.eu-west-2.amazonaws.com/dev/auth/check-auth-code",{authCode:t}).then(function(A){if(console.log("[checkAuth]",A),A&&A.data){var t=A.data.authResult,n=t.authenticated,l=t.opentok;e.setState({authenticated:n,opentok:JSON.stringify(l)}),n&&(e._confettiEffect.render(),clearInterval(a))}})}},{key:"onCompleteCountdown",value:function(){var e=this.props.history,A=this.state.opentok,t=JSON.parse(A),a=t.apiKey,n=t.sessionId,l=t.token;e.push("/videocall?token=".concat(l,"&apiKey=").concat(a,"&sessionId=").concat(n))}},{key:"rendererCountDown",value:function(e){var A=e.seconds;return n.a.createElement("span",null,A)}},{key:"render",value:function(){var e=this.state,A=e.code,t=e.authenticated;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"login-card Vlt-margin--top4"},n.a.createElement("div",{className:"Vlt-card",style:{minWidth:360}},n.a.createElement("div",{className:"Vlt-card__header Vlt-center"},n.a.createElement("h2",null,"Join videocall with your doctor")),n.a.createElement("h5",{className:"Vlt-center"},"To obtain the link, please send back the code below to the same number that sent you the SMS:"),n.a.createElement("div",{className:"login-code-text letter-spacing"},n.a.createElement("span",null,A)),t?n.a.createElement("div",{className:"Vlt-center"},n.a.createElement("h3",{className:"Vlt-green"},"Authenticated"),n.a.createElement("h4",{className:"Vlt-green"},n.a.createElement("span",null,"You will now be redirected to the videocall in: "),n.a.createElement(h.a,{date:Date.now()+this.redirectTimeout,onComplete:this.onCompleteCountdown.bind(this),renderer:this.rendererCountDown}))):n.a.createElement("div",{className:"Vlt-center"},n.a.createElement("div",{className:"Vlt-spinner "})),n.a.createElement("div",{className:"Vlt-center"},n.a.createElement("button",{className:"Vlt-btn Vlt-btn--tertiary"},n.a.createElement(o.b,{to:"/"},"Go Back to login page"))))),n.a.createElement("canvas",{id:"auth-completed-confetti"}))}}]),A}(a.Component),y=Object(r.e)(f),k=t(15),g=function(e){function A(){return Object(i.a)(this,A),Object(m.a)(this,Object(u.a)(A).apply(this,arguments))}return Object(d.a)(A,e),Object(s.a)(A,[{key:"render",value:function(){return n.a.createElement("header",{className:"Vlt-header",style:{backgroundColor:"#117bb8"}},n.a.createElement("h2",{style:{color:"#fff",margin:"0 auto"}},"Doctor Admin page"))}}]),A}(a.Component),C=t(43),w=t.n(C),O=function(e){function A(){var e;return Object(i.a)(this,A),(e=Object(m.a)(this,Object(u.a)(A).call(this))).state={recipient:"",smsSent:!1,apiKey:"",sessionId:"",token:""},e.handleChange=e.handleChange.bind(Object(k.a)(e)),e.sendSMS=e.sendSMS.bind(Object(k.a)(e)),e}return Object(d.a)(A,e),Object(s.a)(A,[{key:"handleChange",value:function(e){this.setState({recipient:e.target.value})}},{key:"sendSMS",value:function(){var e=this,A=this.state,t=A.recipient,a=A.smsSent;t&&!a&&b.a.post("https://auuubonz7g.execute-api.eu-west-2.amazonaws.com/dev/auth/create-auth-code",{recipient:t}).then(function(A){var t=A.data.opentok;e.setState({smsSent:!0,apiKey:t.apiKey,sessionId:t.sessionId,token:t.adminToken})})}},{key:"render",value:function(){var e=this.state,A=e.recipient,t=e.smsSent,a=e.apiKey,l=e.sessionId,c=e.token,o="".concat("https://d3dqye79o8tcoo.cloudfront.net","/videocall?token=").concat(c,"&apiKey=").concat(a,"&sessionId=").concat(l);return n.a.createElement("div",null,n.a.createElement(g,null),n.a.createElement("div",{className:"Vlt-grid Vlt-margin--top4",style:{justifyContent:"center"}},n.a.createElement("div",{className:"Vlt-col Vlt-col--1of2"},n.a.createElement("div",{className:"Vlt-card"},n.a.createElement("div",{className:"Vlt-card__header"},n.a.createElement("h2",null,"Send appointment reminder to your patient")),n.a.createElement("div",{className:"Vlt-form__element"},n.a.createElement("div",null,n.a.createElement("img",{src:w.a,alt:"treatment-patient"}),n.a.createElement("h4",null,"Patient name")),n.a.createElement("div",{style:{margin:"15px 0"}},n.a.createElement("label",{className:"Vlt-label",htmlFor:"phone-number-input"},"Insert user's phone number. "),n.a.createElement("div",{className:"Vlt-input"},n.a.createElement("input",{value:A,style:{width:250,margin:0},type:"number",id:"phone-number-input",onChange:this.handleChange}))),n.a.createElement("button",{className:"Vlt-btn Vlt-btn--primary Vlt-btn--app",onClick:this.sendSMS},"Send")),t&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"Vlt-callout Vlt-callout--good"},n.a.createElement("i",null),n.a.createElement("div",{className:"Vlt-callout__content"},"Great! Now you can join the videocall")),n.a.createElement("div",{className:"Vlt-center"},n.a.createElement("a",{style:{margin:0},className:"Vlt-btn Vlt-btn--secondary",target:"_blank",href:o,rel:"noopener noreferrer"},"Join videocall")))))))}}]),A}(a.Component),I=t(16),N=function(e){function A(){var e;return Object(i.a)(this,A),(e=Object(m.a)(this,Object(u.a)(A).call(this))).apiKey="",e.sessionId="",e.token="",e.state={startVideoCall:!1},e}return Object(d.a)(A,e),Object(s.a)(A,[{key:"componentDidMount",value:function(){var e=v.a.parse(this.props.location.search);this.apiKey=e.apiKey,this.sessionId=e.sessionId,this.token=e.token,this.setState({startVideoCall:!0})}},{key:"render",value:function(){return this.state.startVideoCall?n.a.createElement("div",{className:"videocall-container"},n.a.createElement("div",{className:"videocall-header"},n.a.createElement("h3",{style:{color:"#fff"}},"Videocall")),n.a.createElement("div",{className:"webcam-container"},n.a.createElement(I.OTSession,{apiKey:this.apiKey,sessionId:this.sessionId,token:this.token},n.a.createElement(I.OTPublisher,null),n.a.createElement(I.OTStreams,null,n.a.createElement(I.OTSubscriber,null))))):null}}]),A}(a.Component);var S=function(){return n.a.createElement(o.a,null,n.a.createElement("div",null,n.a.createElement(r.c,null,n.a.createElement(r.a,{path:"/videocall/",component:N}),n.a.createElement(r.a,{path:"/login/",component:y}),n.a.createElement(r.a,{component:O,exact:!0}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},43:function(e,A){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAB6VBMVEVHcEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMIC33AAAAonRSTlMARLvx98U4zDMG3csMMhEi7gQFAQfn4cTrDhL5IBztCunwJAveEB8t6AksAwjUFbL73yn2PALZ3C4qz5Ea4/7b9IxxqTCemsEhm65bbvy6tLCYFhPKzbW+1tWQ75XGVMkPvMDsVpKlr3aZen+s4oihOVoeilmWZlE3reSmbf2GZU74HVM1q71p03BVX8jg5XPqOp0NPsK2vzZkhKKUfk2AQCVgvBDXAAACqElEQVRYw+WXZVcbQRSGbyAUWNo4BBJKQgIEKU4I0gJFixQpDnV3d6Pu7i7vL+2sUDayrBTOoYfnw2Zm7+wzmTuyCZEyTtNMSv100s9GMoZpChITAQOPl4wABd9//a758S0ftQ91P19ajtqXdrHseQP0eVT6a85GDNMhdv/zbOQT+7hri40WXIwWHIhtgCM+dtvnBd7z8bPuuAaXovK9ryUkq+5H206hsKEWeCCU7DdhviNrch1X5IJ0mOXVcZyRSuezmhqkYi82y5qsQYqywOE12+PTVIdJdYHTwhOAP0GeGzElRHMWEfTnSwlKLJCIdCoJwvktNoEbVZctcTyGVwgmo1JJsBbJYvUCEvJECK5Dhqog/Vy1LY5HT0mzYFHUBHYnyS8Oir2oCOzVH1n1xCBbhVcniIKZw0Q5/vtEhdnXiEbzvqoJCpFHVIFioo3YRFSEAqIA6olqUE7UgKZlF4Qnu4jKerrZcN3bWWBHMxvMLrYLfBknid6Of1n+WVgxAhe//MuMCwa8/OK3mYwKXN6tHMdlCU0ZQatIUZlWwTZksut6ZAm13Xnz+7FDm8BnvScJXli3sMPNtZeTOKZJMFDF+hIFjFmT3hw4zPz4Z/jtOMjn4ZlegQfZskguuKUQ5IizwCfEkKBw/rQ+rkVggY115iKx43e8wLVHmoWjWgTOYr4vN79+hPkf0r0S69zcc2kaqziuMtfIUo5eiQYEFXjF8vBaEFisC6RrFYT9YtY/sEQmy95NhzRv57oelvPIMBu/Y4j7S+vh/+lI+zfBaFpiOku0CVw2KFCpTeA8mKpA++qZhVUsCKItTZ1+jCn+Vm6FJroVBaV9qeqMjVjU/i9oYakFDtzWKTgtvDkWqEa7SRen0BUlmINezKHor3SrI0kXvaW0UvgDF+KrMKDX6X4AAAAASUVORK5CYII="},44:function(e,A,t){e.exports=t(115)},49:function(e,A,t){}},[[44,1,2]]]);
//# sourceMappingURL=main.a54656c7.chunk.js.map